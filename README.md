# Energy flow optimal control for parallel HEVs

## English Version
In a conventional vehicle, the driver's power demand is met by the only available energy source, the combustion engine (ICE). In HEVs, a further decision must be made regarding how to distribute the driver's power demand among the various available energy sources. Therefore, an energy management strategy (EMS) is required to determine the power distribution at any given time.

This work focuses on optimizing the power flow between the energy sources (ICE and EM), which constitute the powertrain of a HEV with parallel architecture, over a defined horizon. Optimization involves deciding the amount of power supplied at any given time by the on-board energy sources, based on the power requested, through the development of various control or energy management strategies (EMSs). The aim is to seek an optimal trade-off between total fuel consumption and the loss of energy stored in the battery (Charge-Sustaining) over a defined optimization horizon, satisfying the required power and respecting all operating constraints. The performance of control strategies is tested and compared by simulating standardized driving cycles that emulate different driving conditions (urban, extra-urban, combined). Specifically, driving cycles provide speed fluctuations over time, which allow us to understand how the vehicle behaves, that is, how the powertrain operates most of the time (acceleration, tractive effort, torque, power, etc.).

Energy management in HEVs requires meeting a series of constraints that can be local and/or global. When making a control decision, the implemented strategy must be able to account for the physical limitations of the powertrain components, such as the maximum ICE torque or the minimum battery current, which constitute local constraints. Furthermore, the value of a certain system state variable may also be subject to a predefined requirement. For example, local constraints are often applied to maintain the battery SoC within a predefined range. On the other hand, a target SoC value at the end of the driving cycle is most often required.

Among the various optimal control techniques, analytical optimization methods use an analytical problem formulation to find a solution to the energy management problem in HEVs. Furthermore, they can be used to make the numerical solution faster than that obtained using a purely numerical method, such as dynamic programming (DP). The Pontryagin Minimum Principle (PMP) is one of the most widely used analytical control approaches for the energy management of HEVs. It has been shown that, under certain conditions, PMP provides a non-causal, globally optimal solution.
In the field of model-based control methods that can be implemented in real time, several research efforts have been dedicated to the adaptive equivalent consumption minimization (A-ECMS) strategy, a variant of the equivalent minimum consumption strategy (ECMS).

The Pontryagin Minimum Principle (PMP) and the Equivalent Consumption Minimization Strategy (ECMS) are energy management strategies that allow the optimal distribution of the power to be supplied to the wheels (already known a priori from the driving cycle) between the ICE and EM at any given moment in time, based on the imposed system constraints, for optimal fuel economy and emissions reduction. In other words, the aim of these techniques is to minimize a cost function, such as fuel consumption, through optimal control of the energy flow, respecting the various boundary conditions (system constraints).

## Versione Italiana
In un veicolo convenzionale, la richiesta del conducente viene soddisfatta dall'unica fonte di energia disponibile, ossia il motore a combustione (ICE). Negli HEVs è necessario prendere un'ulteriore decisione su come distribuire la richiesta di potenza del conducente tra le diverse sorgenti di energia disponibili. È quindi necessaria una strategia di gestione dell'energia (EMS) per determinare la ripartizione della potenza in ogni istante.

Questo lavoro è incentrato sull’ottimizzazione del flusso di potenza tra le fonti energetiche (ICE ed EM), che costituiscono il powertrain di un HEV con architettura parallela, su un orizzonte definito. L’ottimizzazione consiste nel decidere la quantità di potenza fornita in ogni istante dalle fonti energetiche di bordo, in funzione della potenza richiesta, attraverso lo sviluppo di diverse strategie di controllo o di gestione dell’energia (EMSs). L’intento è cercare un compromesso ottimale tra il consumo totale di carburante e la perdita di energia immagazzinata nella batteria (Charge-Sustaining) su un orizzonte di ottimizzazione definito soddisfacendo la potenza richiesta e rispettando tutti i vincoli operativi. Le prestazioni delle strategie di controllo vengono testate e confrontate simulando cicli di guida standardizzati che emulano condizioni di guida differenti (urbano, extra-urbano, combinato). In particolare, i cicli di guida forniscono le fluttuazioni di velocità nel tempo, da cui è possibile capire come si comporta il veicolo, ovvero, come opera il powertrain per la maggior parte del tempo (si ricavano accelerazione, sforzo di trazione, coppia, potenza, ecc.).

La gestione energetica degli HEVs comporta il rispetto di una serie di vincoli che possono essere di natura locale e/o globale. Quando si prende una decisione di controllo, la strategia implementata deve essere in grado di tenere conto delle limitazioni fisiche dei componenti del gruppo propulsore, ad esempio la coppia massima dell'ICE o la corrente minima della batteria, che costituiscono vincoli locali. Inoltre, anche il valore di una certa variabile di stato del sistema potrebbe essere soggetto a soddisfare un requisito predefinito. Ad esempio, i vincoli locali sono spesso applicati per mantenere il SoC della batteria entro un intervallo prestabilito. D'altra parte, la maggior parte delle volte è richiesto un valore SoC target al termine del ciclo di guida.

Tra le differenti tecniche di controllo ottimo, i metodi di ottimizzazione analitica utilizzano una formulazione analitica del problema per trovare una soluzione al problema della gestione dell'energia negli HEVs. Inoltre, possono essere utilizzati per rendere la soluzione numerica più veloce di quella che si otterrebbe utilizzando un metodo puramente numerico, come la programmazione dinamica (DP). Il Principio Minimo di Pontryagin (PMP) è uno degli approcci di controllo analitico più utilizzati per la gestione energetica degli HEVs. È stato dimostrato che, in determinate condizioni, il PMP fornisce una soluzione non causale che è globalmente ottimale.
Nel campo dei metodi di controllo basati su modelli implementabili in tempo reale, diversi sforzi di ricerca sono stati dedicati alla strategia di minimizzazione del consumo equivalente adattiva (A-ECMS), una sua variante della strategia di consumo minimo equivalente (ECMS).

Il Principio Minimo di Pontryagin (PMP) e la Strategia di Minimizzazione del Consumo Equivalente (ECMS), sono strategie di gestione dell’energia che consentono di ripartire in modo ottimale, tra ICE ed EM, la potenza da fornire alle ruote (già nota a priori dal ciclo di guida) in ogni istante temporale, sulla base dei vincoli di sistema imposti, per un risparmio di carburante e riduzione delle emissioni ottimale. In altre parole, lo scopo di queste tecniche è quello di minimizzare una funzione costo, come può essere il consumo di carburante, attraverso il controllo ottimale del flusso energetico, rispettando le varie condizioni al contorno (vincoli di sistema).
